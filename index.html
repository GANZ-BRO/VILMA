<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Matematika gyakorl√°s</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; background: #181c25; color: #f7f7f7; margin: 0; }
    main { max-width: 480px; margin: auto; padding: 1em; }
    h1 { font-size: 1.4em; }
    select, button, input, .numpad-btn {
      font-size: 1.1em; padding: 0.4em 0.7em; border-radius: 7px;
      border: 1px solid #444; background: #232737; color: #fff;
    }
    .category-row, .settings-row { display: flex; flex-wrap: wrap; gap: 1em; align-items: center; margin-bottom: 1em;}
    .settings-row label { font-size: 1em; }
    .problem-card {
      background: #232737; border-radius: 8px; margin-bottom: 1em; padding: 0.7em;
      box-shadow: 0 2px 8px 0 rgba(0,0,0,0.09);
    }
    .answer-view { min-height: 1.5em; margin-bottom: 0.5em; }
    .feedback { margin-top: 0.5em; }
    .feedback.correct { color: #79ec7d; }
    .feedback.wrong { color: #ff4d4d; }
    .numpad { display: flex; flex-wrap: wrap; gap: 0.5em; margin: 0.5em 0; }
    .numpad-btn { min-width: 2.2em; }
    .summary-list { padding-left: 1.2em; }
    .best { font-size: 0.95em; margin-bottom: 1em; color: #ffe066; }
  </style>
</head>
<body>
  <main>
    <h1>Matematika gyakorl√°s</h1>
    <div class="category-row">
      <label for="category">Kateg√≥ria:</label>
      <select id="category">
        <option value="" selected disabled>V√°lassz kateg√≥ri√°t</option>
        <option value="√ñsszead√°s">√ñsszead√°s</option>
        <option value="Kivon√°s">Kivon√°s</option>
        <option value="Szorz√°s">Szorz√°s</option>
        <option value="Oszt√°s">Oszt√°s</option>
        <option value="Mind a n√©gy m≈±velet">Mind a n√©gy m≈±velet</option>
        <option value="Z√°r√≥jeles kifejez√©sek">Z√°r√≥jeles kifejez√©sek</option>
        <option value="T√∂rtek">T√∂rtek</option>
        <option value="Sz√°zal√©ksz√°m√≠t√°s">Sz√°zal√©ksz√°m√≠t√°s</option>
        <option value="Egyenletek √°trendez√©se">Egyenletek √°trendez√©se</option>
      </select>
      <label for="difficulty">Neh√©zs√©g:</label>
      <select id="difficulty">
        <option value="" selected disabled>V√°lassz neh√©zs√©get</option>
        <option value="easy">K√∂nny≈±</option>
        <option value="medium">K√∂zepes</option>
        <option value="hard">Neh√©z</option>
      </select>
    </div>
    <div class="settings-row">
      <button id="restart-btn" style="display:none;">√öjra</button>
      <span id="timer">‚è±Ô∏è 0 mp</span>
      <span id="score">üèÖ 0</span>
    </div>
    <div class="best" id="best-stats" style="display:none;"></div>
    <div id="problems"></div>
    <div id="summary"></div>
  </main>
  <script>
    // --- Feladatgener√°l√≥ f√ºggv√©nyek innen (probl√©ma t√≠pusok) ---
    function gcd(a, b) { while (b) [a, b] = [b, a % b]; return Math.abs(a); }
    function simplifyFraction(num, den) {
      const sign = (num * den) < 0 ? "-" : "";
      num = Math.abs(num); den = Math.abs(den);
      const d = gcd(num, den);
      return sign + (num/d) + "/" + (den/d);
    }
    function randInt(a, b) { return Math.floor(Math.random() * (b - a + 1)) + a; }
    function generateAddition(difficulty) {
      let range = {easy:[1,30], medium:[-20,60], hard:[-100,150]}[difficulty];
      return Array.from({length:10}, () => {
        let a = randInt(...range), b = randInt(...range);
        return { question:`${a} + ${b} = ?`, answer:a+b, explanation:`Az √∂sszead√°s eredm√©nye: ${a} + ${b} = ${a+b}` };
      });
    }
    function generateSubtraction(difficulty) {
      let range = {easy:[5,40], medium:[-30,70], hard:[-120,170]}[difficulty];
      return Array.from({length:10}, () => {
        let a = randInt(...range), b = randInt(...range);
        return { question:`${a} - ${b} = ?`, answer:a-b, explanation:`A kivon√°s eredm√©nye: ${a} - ${b} = ${a-b}` };
      });
    }
    function generateMultiplication(difficulty) {
      let range = {easy:[2,10], medium:[-10,15], hard:[-20,25]}[difficulty];
      return Array.from({length:10}, () => {
        let a = randInt(...range), b = randInt(...range);
        return { question:`${a} √ó ${b} = ?`, answer:a*b, explanation:`A szorz√°s eredm√©nye: ${a} √ó ${b} = ${a*b}` };
      });
    }
    function generateDivision(difficulty) {
      let range = {easy:[2,10], medium:[-10,15], hard:[-20,25]}[difficulty];
      return Array.from({length:10}, () => {
        let b = 0; while (b === 0) b = randInt(...range);
        let ans = randInt(-10, 15);
        let a = b * ans;
        return { question:`${a} √∑ ${b} = ?`, answer:ans, explanation:`${a} √∑ ${b} = ${ans}` };
      });
    }
    function generateMixed(difficulty) {
      const ops = ["+", "-", "√ó", "√∑"];
      let arr = [];
      let ranges = {
        "+": {easy:[1,30], medium:[-20,60], hard:[-100,150]},
        "-": {easy:[5,40], medium:[-30,70], hard:[-120,170]},
        "√ó": {easy:[2,10], medium:[-10,15], hard:[-20,25]},
        "√∑": {easy:[2,10], medium:[-10,15], hard:[-20,25]}
      };
      for (let i = 0; i < 10; i++) {
        let op = ops[randInt(0,3)];
        let a, b, ans, q, expl;
        if (op === "+") {
          a = randInt(...ranges["+"]. [difficulty]); b = randInt(...ranges["+"]. [difficulty]);
          ans = a + b; q = `${a} + ${b} = ?`; expl = `Az √∂sszead√°s eredm√©nye: ${a} + ${b} = ${ans}`;
        } else if (op === "-") {
          a = randInt(...ranges["-"]. [difficulty]); b = randInt(...ranges["-"]. [difficulty]);
          ans = a - b; q = `${a} - ${b} = ?`; expl = `A kivon√°s eredm√©nye: ${a} - ${b} = ${ans}`;
        } else if (op === "√ó") {
          a = randInt(...ranges["√ó"]. [difficulty]); b = randInt(...ranges["√ó"]. [difficulty]);
          ans = a * b; q = `${a} √ó ${b} = ?`; expl = `A szorz√°s eredm√©nye: ${a} √ó ${b} = ${ans}`;
        } else {
          b = 0; while (b === 0) b = randInt(...ranges["√∑"]. [difficulty]);
          ans = randInt(-10, 15); a = b * ans;
          q = `${a} √∑ ${b} = ?`; expl = `${a} √∑ ${b} = ${ans}`;
        }
        arr.push({question:q, answer:ans, explanation:expl});
      }
      return arr;
    }
    function generateParentheses(difficulty) {
      let arr = [];
      let r = {easy:[1,10], medium:[-10,20], hard:[-20,30]}[difficulty];
      for(let i=0;i<10;i++){
        let type = randInt(1,3);
        let a = randInt(...r), b = randInt(...r), c = randInt(-5,5);
        let q, ans, expl;
        if(type===1){
          q = `(${a} + ${b}) √ó ${c} = ?`; ans=(a+b)*c; expl=`El≈ësz√∂r z√°r√≥jel: ${a}+${b}=${a+b}, majd szorz√°s: ${a+b}√ó${c}=${ans}`;
        } else if(type===2){
          q = `(${a} - ${b}) + ${c} = ?`; ans=(a-b)+c; expl=`Z√°r√≥jel: ${a}-${b}=${a-b}, majd √∂sszead√°s: ${a-b}+${c}=${ans}`;
        } else {
          q = `${a} + (${b} √ó ${c}) = ?`; ans=a+(b*c); expl=`Z√°r√≥jel: ${b}√ó${c}=${b*c}, majd √∂sszead√°s: ${a}+${b*c}=${ans}`;
        }
        arr.push({question:q, answer:ans, explanation:expl});
      }
      return arr;
    }
    function generateFractions(difficulty) {
      let arr = [];
      for(let i=0;i<10;i++){
        let type = randInt(1,2);
        let n1=randInt(1,9),d1=randInt(2,10),n2=randInt(1,9),d2=randInt(2,10);
        if(type===1){
          let common=d1*d2,num=n1*d2+n2*d1;
          arr.push({
            question:`${n1}/${d1} + ${n2}/${d2} = ?`,
            answer:simplifyFraction(num,common),
            explanation:`K√∂z√∂s nevez≈ë: ${d1}√ó${d2}=${common}, sz√°ml√°l√≥: ${n1}√ó${d2}+${n2}√ó${d1}=${n1*d2}+${n2*d1}=${num}, egyszer≈±s√≠tve: ${simplifyFraction(num,common)}`
          });
        } else {
          let num=n1*n2,den=d1*d2;
          arr.push({
            question:`${n1}/${d1} √ó ${n2}/${d2} = ?`,
            answer:simplifyFraction(num,den),
            explanation:`Sz√°ml√°l√≥k szorzata: ${n1}√ó${n2}=${num}, nevez≈ëk szorzata: ${d1}√ó${d2}=${den}, egyszer≈±s√≠tve: ${simplifyFraction(num,den)}`
          });
        }
      }
      return arr;
    }
    function generatePercent(difficulty) {
      let arr = [];
      for(let i=0;i<10;i++){
        let base=randInt(10,200),perc=randInt(5,90);
        let askType=randInt(0,1);
        if(askType===0){
          arr.push({
            question:`Mi a ${perc}%-a a ${base}-nak/nek?`,
            answer:Math.round(base*perc/100),
            explanation:`${base} √ó ${perc}% = ${base} √ó ${perc}/100 = ${Math.round(base*perc/100)}`
          });
        } else {
          let value=randInt(1,base);
          arr.push({
            question:`A ${base}-nak h√°ny %-a a ${value}?`,
            answer:Math.round((value/base)*100),
            explanation:`${value} √∑ ${base} √ó 100 = ${Math.round((value/base)*100)}%`
          });
        }
      }
      return arr;
    }
    function generateEquations(difficulty) {
      let arr = [];
      for(let i=0;i<10;i++){
        let x=randInt(-15,20);
        let type=randInt(0,1);
        if(type===0){
          let a=randInt(-10,10),b=x+a;
          arr.push({
            question:`Oldd meg: x + ${a} = ${b}`,
            answer:x,
            explanation:`x = ${b} - (${a}) = ${b-a}`
          });
        } else {
          let k=randInt(2,8),b=x*k;
          arr.push({
            question:`Oldd meg: ${k}x = ${b}`,
            answer:x,
            explanation:`x = ${b} √∑ ${k} = ${b/k}`
          });
        }
      }
      return arr;
    }
    function getProblemsByTopicAndDifficulty(topic, difficulty) {
      switch (topic) {
        case "√ñsszead√°s": return generateAddition(difficulty);
        case "Kivon√°s": return generateSubtraction(difficulty);
        case "Szorz√°s": return generateMultiplication(difficulty);
        case "Oszt√°s": return generateDivision(difficulty);
        case "Mind a n√©gy m≈±velet": return generateMixed(difficulty);
        case "Z√°r√≥jeles kifejez√©sek": return generateParentheses(difficulty);
        case "T√∂rtek": return generateFractions(difficulty);
        case "Sz√°zal√©ksz√°m√≠t√°s": return generatePercent(difficulty);
        case "Egyenletek √°trendez√©se": return generateEquations(difficulty);
        default: return [];
      }
    }
    // --- Feladatgener√°l√°s v√©ge ---

    // --- Automatikus ind√≠t√°s logika ---
    let problems = [];
    let current = 0, score = 0, timer = 0, timerInterval;

    function resetUI() {
      document.getElementById("problems").innerHTML = "";
      document.getElementById("summary").innerHTML = "";
      document.getElementById("score").textContent = "üèÖ 0";
      document.getElementById("timer").textContent = "‚è±Ô∏è 0 mp";
      document.getElementById("restart-btn").style.display = "none";
      document.getElementById("best-stats").style.display = "none";
    }

    function startPractice() {
      resetUI();
      const category = document.getElementById('category').value;
      const difficulty = document.getElementById('difficulty').value;
      if (!category || !difficulty) return; // csak akkor indul, ha mindkett≈ë van

      problems = getProblemsByTopicAndDifficulty(category, difficulty);
      current = 0;
      score = 0;
      timer = 0;
      document.getElementById("score").textContent = "üèÖ 0";
      document.getElementById("timer").textContent = "‚è±Ô∏è 0 mp";
      document.getElementById("restart-btn").style.display = "inline";
      showProblem();
      startTimer();
    }

    function showProblem() {
      if (current >= problems.length) return showSummary();
      const problem = problems[current];
      const problemsDiv = document.getElementById("problems");
      problemsDiv.innerHTML = `
        <div class="problem-card">
          <div>${problem.question}</div>
          <input id="answer-input" type="text" autocomplete="off" style="margin-top:0.8em;">
          <button id="submit-btn">K√ºld√©s</button>
          <div id="feedback"></div>
        </div>
      `;
      document.getElementById("answer-input").focus();
      document.getElementById("submit-btn").onclick = checkAnswer;
      document.getElementById("answer-input").onkeydown = function(e){
        if (e.key === "Enter") checkAnswer();
      };
    }

    function checkAnswer() {
      const input = document.getElementById("answer-input").value.trim();
      const problem = problems[current];
      let correct = input == problem.answer;
      let feedback = document.getElementById("feedback");
      if (correct) {
        score++;
        feedback.textContent = "Helyes! ‚úîÔ∏è";
        feedback.className = "feedback correct";
      } else {
        feedback.textContent = `Helytelen! üò¢ Helyes v√°lasz: ${problem.answer}`;
        feedback.className = "feedback wrong";
      }
      document.getElementById("score").textContent = `üèÖ ${score}`;
      setTimeout(() => {
        current++;
        showProblem();
      }, 900);
    }

    function showSummary() {
      stopTimer();
      document.getElementById("problems").innerHTML = "";
      document.getElementById("summary").innerHTML =
        `<div class="problem-card"><strong>V√©ge! Pontsz√°m: ${score} / ${problems.length}</strong></div>`;
    }

    function startTimer() {
      stopTimer();
      timer = 0;
      timerInterval = setInterval(() => {
        timer++;
        document.getElementById("timer").textContent = `‚è±Ô∏è ${timer} mp`;
      }, 1000);
    }
    function stopTimer() { clearInterval(timerInterval); }

    document.getElementById("category").addEventListener("change", startPractice);
    document.getElementById("difficulty").addEventListener("change", startPractice);
    document.getElementById("restart-btn").onclick = startPractice;

    // Alap√°llapot reset
    resetUI();
  </script>
</body>
</html>
